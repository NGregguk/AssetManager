@model Asset
@{
    ViewData["Title"] = "Asset details";
}

<section class="page-header">
    <div>
        <h1>@Model.Name</h1>
        <p class="muted">@(string.IsNullOrWhiteSpace(Model.Tag) ? "No tag assigned" : $"Tag {Model.Tag}")</p>
    </div>
    <div class="header-actions">
        <a class="button ghost" asp-action="Edit" asp-route-id="@Model.Id">Edit</a>
        <a class="button ghost" asp-controller="Map" asp-action="Index" asp-route-assetId="@Model.Id">Show on map</a>
        <a class="button danger" asp-action="Delete" asp-route-id="@Model.Id">Delete</a>
    </div>
</section>

<section class="content-grid">
    <div class="panel">
        <div class="panel-header">
            <h2>Details</h2>
            <span class="pill">@Model.Status</span>
        </div>
        <dl class="details-grid">
            <div>
                <dt>Category</dt>
                <dd>@(Model.Category?.Name ?? "Uncategorised")</dd>
            </div>
            <div>
                <dt>Location</dt>
                <dd>@(Model.Location?.Name ?? "Unassigned")</dd>
            </div>
            <div>
                <dt>Vendor</dt>
                <dd>@(Model.Vendor?.Name ?? "Not set")</dd>
            </div>
            <div>
                <dt>Computer name</dt>
                <dd>@(Model.ComputerName ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Manufacturer</dt>
                <dd>@(Model.Manufacturer ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Model</dt>
                <dd>@(Model.Model ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Architecture</dt>
                <dd>@(Model.Architecture ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>CPU</dt>
                <dd>@(Model.Cpu ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Cores</dt>
                <dd>@(Model.Cores?.ToString() ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Logical processors</dt>
                <dd>@(Model.LogicalProcessors?.ToString() ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Operating system</dt>
                <dd>@(Model.OperatingSystem ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>OS version</dt>
                <dd>@(Model.OsVersion ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>OS build</dt>
                <dd>@(Model.OsBuild ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>BIOS serial</dt>
                <dd>@(Model.BiosSerial ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>BIOS version</dt>
                <dd>@(Model.BiosVersion ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Install date</dt>
                <dd>@(Model.InstallDate?.ToString("dd MMM yyyy") ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Storage space</dt>
                <dd>@(Model.Space ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Total RAM (GB)</dt>
                <dd>@(Model.TotalRamGb?.ToString("0.##") ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Serial number</dt>
                <dd>@(Model.SerialNumber ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Purchase date</dt>
                <dd>@(Model.PurchaseDate?.ToString("dd MMM yyyy") ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Purchase cost</dt>
                <dd>@(Model.PurchaseCost?.ToString("C") ?? "Not recorded")</dd>
            </div>
            <div>
                <dt>Warranty expiry</dt>
                <dd>@(Model.WarrantyExpiry?.ToString("dd MMM yyyy") ?? "Not recorded")</dd>
            </div>
            <div class="span-2">
                <dt>Description</dt>
                <dd>@(string.IsNullOrWhiteSpace(Model.Description) ? "No description provided." : Model.Description)</dd>
            </div>
        </dl>
    </div>

    <div class="panel">
        <div class="panel-header">
            <h2>Assignment history</h2>
            <a class="text-link" asp-action="Assignments" asp-route-id="@Model.Id">Full history</a>
        </div>
        <div class="timeline">
            @if (Model.Assignments.Count == 0)
            {
                <div class="empty-state">No assignment records yet.</div>
            }
            else
            {
                foreach (var item in Model.Assignments.Take(4))
                {
                    <div class="timeline-item">
                        <div>
                            <div class="asset-name">@item.AssignedTo</div>
                            <div class="muted">Assigned @item.AssignedDate.ToString("dd MMM yyyy")</div>
                        </div>
                        <div class="muted">@(
                            item.ReturnedDate == null ? "Active" : $"Returned {item.ReturnedDate.Value:dd MMM yyyy}"
                        )</div>
                    </div>
                }
            }
        </div>
    </div>
</section>

<section class="panel">
    <div class="panel-header">
        <h2>Maintenance log</h2>
        <a class="text-link" asp-action="Maintenance" asp-route-id="@Model.Id">View log</a>
    </div>
    <div class="timeline">
        @if (Model.MaintenanceRecords.Count == 0)
        {
            <div class="empty-state">No maintenance logged for this asset.</div>
        }
        else
        {
            foreach (var record in Model.MaintenanceRecords.Take(4))
            {
                <div class="timeline-item">
                    <div>
                        <div class="asset-name">@record.Summary</div>
                        <div class="muted">@record.MaintenanceDate.ToString("dd MMM yyyy")</div>
                    </div>
                    <div class="muted">@((record.Cost?.ToString("C")) ?? "No cost")</div>
                </div>
            }
        }
    </div>
</section>
